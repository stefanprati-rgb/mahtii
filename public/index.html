<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Sistema de gestão integrado para pequenos negócios de moda. Controle vendas, estoque, produção e financeiro em um só lugar.">
    <title>Sistema de Gestão - MAHTIÍ</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/styles.css">
</head>

<body class="antialiased">
    <div class="flex h-screen bg-gray-100">
        <aside id="sidebar"
            class="sidebar w-64 fixed lg:static top-0 left-0 h-full bg-white shadow-lg z-30 flex flex-col">
            <div class="px-6 py-4 border-b">
                <h1 class="text-2xl font-bold text-gray-800">MAHTIÍ ERP</h1>
            </div>
            <nav class="flex-grow p-4 space-y-2">
                <a href="#dashboard" class="nav-link flex items-center py-2 px-4 rounded-lg active">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                        </path>
                    </svg>
                    Dashboard
                </a>
                <a href="#materiaprima" class="nav-link flex items-center py-2 px-4 rounded-lg">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10">
                        </path>
                    </svg>
                    Matéria-Prima
                </a>
                <a href="#producao" class="nav-link flex items-center py-2 px-4 rounded-lg">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z">
                        </path>
                    </svg>
                    Produção
                </a>
                <a href="#estoque" class="nav-link flex items-center py-2 px-4 rounded-lg">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4">
                        </path>
                    </svg>
                    Estoque
                </a>
                <a href="#vendas" class="nav-link flex items-center py-2 px-4 rounded-lg">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z">
                        </path>
                    </svg>
                    Vendas
                </a>
                <a href="#financeiro" class="nav-link flex items-center py-2 px-4 rounded-lg">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z">
                        </path>
                    </svg>
                    Financeiro
                </a>
                <a href="#relatorios" class="nav-link flex items-center py-2 px-4 rounded-lg">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                    </svg>
                    Relatórios
                </a>
            </nav>
        </aside>

        <div class="main-content flex-1 flex flex-col overflow-hidden">
            <header class="bg-white shadow-md p-4 flex justify-between items-center">
                <button id="hamburger-btn"
                    class="lg:hidden p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 6h16M4 12h16m-7 6h7"></path>
                    </svg>
                </button>
                <div id="breadcrumbs" class="text-sm text-gray-500">
                    <a href="#dashboard" class="hover:text-blue-600">Dashboard</a>
                </div>
                <div></div>
            </header>
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-4 sm:p-6 lg:p-8">
                <section id="dashboard" role="tabpanel" class="space-y-8">
                    <div id="dashboard-content"></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-stretch">
                        <div class="card p-6 h-full flex flex-col">
                            <h3 class="text-xl font-semibold mb-4">Receita vs. Custos vs. Lucro</h3>
                            <div id="lucro-chart-card" class="flex-1 h-80"></div>
                        </div>
                        <div class="card p-6 h-full flex flex-col">
                            <h3 class="text-xl font-semibold mb-4">Produtos Mais Vendidos</h3>
                            <div id="produtos-chart-card" class="flex-1 h-80"></div>
                        </div>
                    </div>
                </section>

                <section id="materiaprima" role="tabpanel" class="hidden space-y-6">
                    <div class="card p-6">
                        <div class="flex flex-wrap justify-between items-center gap-4 mb-4">
                            <h2 class="text-2xl font-bold text-gray-800">Estoque de Matéria-Prima</h2>
                            <div>
                                <button onclick="openModal('modal-nova-compra')"
                                    class="btn-primary font-semibold py-2 px-4 rounded-md">Registrar Compra</button>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label for="insumo-filter-fornecedor"
                                class="block text-sm font-medium text-gray-700">Filtrar por Fornecedor:</label>
                            <select id="insumo-filter-fornecedor"
                                class="mt-1 block w-full md:w-1/3 border-gray-300 rounded-md shadow-sm p-2">
                                <option value="">Todos os Fornecedores</option>
                            </select>
                        </div>
                        <div id="insumos-content"></div>
                    </div>
                </section>

                <section id="producao" role="tabpanel" class="hidden space-y-6">
                    <div class="card p-6">
                        <div class="flex flex-wrap justify-between items-center gap-4 mb-4">
                            <h2 class="text-2xl font-bold text-gray-800">Controle de Produção</h2>
                            <div>
                                <button onclick="openModal('modal-nova-producao')"
                                    class="btn-primary font-semibold py-2 px-4 rounded-md">Novo Lote</button>
                            </div>
                        </div>
                        <div id="producao-content"></div>
                    </div>
                </section>

                <section id="estoque" role="tabpanel" class="hidden space-y-6">
                    <div class="card p-6">
                        <div class="flex flex-wrap justify-between items-center gap-4 mb-4">
                            <h2 class="text-2xl font-bold text-gray-800">Estoque de Produtos Acabados</h2>
                            <div>
                                <button onclick="openModal('modal-novo-produto')"
                                    class="btn-primary font-semibold py-2 px-4 rounded-md">Novo Produto Avulso</button>
                            </div>
                        </div>
                        <div id="estoque-content"></div>
                    </div>
                </section>

                <section id="vendas" role="tabpanel" class="hidden space-y-6">
                    <div class="card p-6">
                        <div class="flex flex-wrap justify-between items-center gap-4 mb-4">
                            <h2 class="text-2xl font-bold text-gray-800">Registro de Vendas</h2>
                            <div>
                                <button onclick="openModal('modal-nova-venda')"
                                    class="btn-primary font-semibold py-2 px-4 rounded-md">Adicionar Venda</button>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-4 mb-4 p-4 bg-gray-50 rounded-lg">
                            <div class="flex-1 min-w-[200px]">
                                <label for="vendas-filter-search" class="block text-sm font-medium text-gray-700">Buscar
                                    por Cliente/Produto:</label>
                                <input type="text" id="vendas-filter-search" placeholder="Digite para buscar..."
                                    class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                            </div>
                            <div class="flex-1 min-w-[150px]">
                                <label for="vendas-filter-start-date"
                                    class="block text-sm font-medium text-gray-700">Data Início:</label>
                                <input type="text" id="vendas-filter-start-date" placeholder="AAAA-MM-DD"
                                    class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                            </div>
                            <div class="flex-1 min-w-[150px]">
                                <label for="vendas-filter-end-date" class="block text-sm font-medium text-gray-700">Data
                                    Fim:</label>
                                <input type="text" id="vendas-filter-end-date" placeholder="AAAA-MM-DD"
                                    class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                            </div>
                        </div>
                        <div id="vendas-analytics" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-center">
                            <div class="bg-blue-100 p-4 rounded-lg">
                                <p class="text-sm font-medium text-blue-800">Total Vendido (Período)</p>
                                <p id="vendas-kpi-total" class="text-2xl font-bold text-blue-600">R$ 0,00</p>
                            </div>
                            <div class="bg-green-100 p-4 rounded-lg">
                                <p class="text-sm font-medium text-green-800">Total de Pedidos</p>
                                <p id="vendas-kpi-pedidos" class="text-2xl font-bold text-green-600">0</p>
                            </div>
                            <div class="bg-purple-100 p-4 rounded-lg">
                                <p class="text-sm font-medium text-purple-800">Melhor Cliente</p>
                                <p id="vendas-kpi-cliente" class="text-lg font-bold text-purple-600 truncate">—</p>
                            </div>
                        </div>
                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4">Top 5 Clientes por Receita</h3>
                            <div id="clientes-chart-card" class="h-80"></div>
                        </div>
                        <div id="vendas-content"></div>
                    </div>
                </section>

                <section id="financeiro" role="tabpanel" class="hidden space-y-6">
                    <div class="card p-6">
                        <div class="flex flex-wrap justify-between items-center gap-4 mb-4">
                            <h2 class="text-2xl font-bold text-gray-800">Fluxo de Caixa</h2>
                            <div>
                                <button onclick="openModal('modal-nova-transacao')"
                                    class="btn-primary font-semibold py-2 px-4 rounded-md">Nova Transação</button>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-center">
                            <div class="bg-green-100 p-4 rounded-lg">
                                <p class="text-sm font-medium text-green-800">Total de Entradas</p>
                                <p id="financeiro-entradas" class="text-2xl font-bold text-green-600">R$ 0,00</p>
                            </div>
                            <div class="bg-red-100 p-4 rounded-lg">
                                <p class="text-sm font-medium text-red-800">Total de Saídas</p>
                                <p id="financeiro-saidas" class="text-2xl font-bold text-red-600">R$ 0,00</p>
                            </div>
                            <div class="bg-blue-100 p-4 rounded-lg">
                                <p class="text-sm font-medium text-blue-800">Saldo Atual</p>
                                <p id="financeiro-saldo" class="text-2xl font-bold text-blue-600">R$ 0,00</p>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-4 mb-4 p-4 bg-gray-50 rounded-lg">
                            <div class="flex-1 min-w-[200px]">
                                <label for="financeiro-filter-search"
                                    class="block text-sm font-medium text-gray-700">Buscar por
                                    Descrição/Categoria:</label>
                                <input type="text" id="financeiro-filter-search" placeholder="Digite para buscar..."
                                    class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                            </div>
                            <div class="flex-1 min-w-[150px]">
                                <label for="financeiro-filter-start-date"
                                    class="block text-sm font-medium text-gray-700">Data Início:</label>
                                <input type="text" id="financeiro-filter-start-date" placeholder="AAAA-MM-DD"
                                    class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                            </div>
                            <div class="flex-1 min-w-[150px]">
                                <label for="financeiro-filter-end-date"
                                    class="block text-sm font-medium text-gray-700">Data Fim:</label>
                                <input type="text" id="financeiro-filter-end-date" placeholder="AAAA-MM-DD"
                                    class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                            </div>
                        </div>
                        <div id="financeiro-content"></div>
                    </div>
                </section>

                <section id="relatorios" role="tabpanel" class="hidden space-y-6">
                    <div class="card p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">Exportar Relatórios</h2>
                        <div class="max-w-md space-y-4">
                            <div>
                                <label for="report-select"
                                    class="block text-sm font-medium text-gray-700 mb-1">Selecione o relatório:</label>
                                <select id="report-select"
                                    class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2">
                                    <option value="vendas">Relatório de Vendas</option>
                                    <option value="estoque">Relatório de Estoque (Produtos Acabados)</option>
                                    <option value="materiaprima">Relatório de Matéria-Prima</option>
                                    <option value="producao">Relatório de Produção</option>
                                    <option value="financeiro">Relatório Financeiro</option>
                                </select>
                            </div>
                            <div class="flex items-center gap-4 pt-4">
                                <button id="export-csv-btn"
                                    class="btn-secondary font-semibold py-2 px-4 rounded-md w-full">Exportar
                                    CSV</button>
                                <button id="export-pdf-btn"
                                    class="bg-red-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-red-600 w-full">Exportar
                                    PDF</button>
                            </div>
                        </div>
                        <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                            <p class="text-sm text-gray-600"><span class="font-semibold">Nota:</span> Os relatórios
                                exportados refletirão os filtros de data e busca atualmente aplicados em suas
                                respectivas seções.</p>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <div id="modal-nova-venda" class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop opacity-0">
        <div class="card p-8 rounded-lg w-11/12 md:w-1/2 lg:w-1/3 modal-content transform scale-95">
            <h3 class="text-2xl font-bold mb-6">Registrar Nova Venda</h3>
            <form id="form-nova-venda" class="space-y-4">
                <input type="hidden" id="venda-id">
                <div>
                    <label for="venda-data" class="block text-sm font-medium text-gray-700">Data da Venda</label>
                    <input type="text" id="venda-data" placeholder="AAAA-MM-DD"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="venda-cliente" class="block text-sm font-medium text-gray-700">Nome do Cliente</label>
                    <input type="text" id="venda-cliente"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="venda-sku" class="block text-sm font-medium text-gray-700">Produto (SKU)</label>
                    <select id="venda-sku" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"
                        required></select>
                </div>
                <div>
                    <label for="venda-qtd" class="block text-sm font-medium text-gray-700">Quantidade</label>
                    <input type="number" id="venda-qtd" min="1" value="1"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="venda-preco" class="block text-sm font-medium text-gray-700">Preço de Venda
                        (unitário)</label>
                    <input type="number" step="0.01" id="venda-preco" min="0"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="venda-status" class="block text-sm font-medium text-gray-700">Status</label>
                    <select id="venda-status" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"
                        required>
                        <option>Entregue</option>
                        <option>Pendente</option>
                        <option>Cancelado</option>
                    </select>
                </div>
                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" onclick="closeModal('modal-nova-venda')"
                        class="font-semibold py-2 px-4 rounded-md border border-gray-300 hover:bg-gray-100">Cancelar</button>
                    <button type="submit" class="btn-primary font-semibold py-2 px-4 rounded-md">Salvar Venda</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-novo-produto" class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop opacity-0">
        <div class="card p-8 rounded-lg w-11/12 md:w-1/2 lg:w-1/3 modal-content transform scale-95">
            <h3 class="text-2xl font-bold mb-6">Cadastrar Novo Produto</h3>
            <form id="form-novo-produto" class="space-y-4">
                <input type="hidden" id="produto-source" value="">
                <div>
                    <label for="produto-sku" class="block text-sm font-medium text-gray-700">Nome do Produto
                        (SKU)</label>
                    <input type="text" id="produto-sku" placeholder="Ex: CAMISA AZUL G"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="produto-custo" class="block text-sm font-medium text-gray-700">Custo Inicial / de Compra
                        (R$)</label>
                    <input type="number" step="0.01" id="produto-custo" min="0" value="0"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                    <p class="mt-1 text-xs text-gray-500">Para produtos fabricados, o custo será calculado e atualizado
                        automaticamente após a finalização do primeiro lote de produção.</p>
                </div>
                <div>
                    <label for="produto-estoque-inicial" class="block text-sm font-medium text-gray-700">Quantidade
                        Inicial</label>
                    <input type="number" id="produto-estoque-inicial" min="0" value="0"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="produto-estoque-minimo" class="block text-sm font-medium text-gray-700">Estoque
                        Mínimo</label>
                    <input type="number" id="produto-estoque-minimo" min="1" value="5"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" onclick="closeModal('modal-novo-produto')"
                        class="font-semibold py-2 px-4 rounded-md border border-gray-300 hover:bg-gray-100">Cancelar</button>
                    <button type="submit" class="btn-primary font-semibold py-2 px-4 rounded-md">Salvar Produto</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-editar-produto"
        class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop opacity-0">
        <div class="card p-8 rounded-lg w-11/12 md:w-1/2 lg:w-1/3 modal-content transform scale-95">
            <h3 class="text-2xl font-bold mb-6">Editar Produto</h3>
            <form id="form-editar-produto" class="space-y-4">
                <input type="hidden" id="edit-produto-id">
                <div>
                    <label for="edit-produto-sku" class="block text-sm font-medium text-gray-700">Nome do Produto
                        (SKU)</label>
                    <input type="text" id="edit-produto-sku"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                </div>
                <div>
                    <label for="edit-produto-custo" class="block text-sm font-medium text-gray-700">Custo Médio Unitário
                        (R$)</label>
                    <input type="number" step="0.01" id="edit-produto-custo" min="0"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="edit-produto-estoque" class="block text-sm font-medium text-gray-700">Quantidade em
                        Estoque</label>
                    <input type="number" id="edit-produto-estoque" min="0"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="edit-produto-estoque-minimo" class="block text-sm font-medium text-gray-700">Estoque
                        Mínimo</label>
                    <input type="number" id="edit-produto-estoque-minimo" min="1"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" onclick="closeModal('modal-editar-produto')"
                        class="font-semibold py-2 px-4 rounded-md border border-gray-300 hover:bg-gray-100">Cancelar</button>
                    <button type="submit" class="btn-primary font-semibold py-2 px-4 rounded-md">Salvar
                        Alterações</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-nova-compra" class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop opacity-0">
        <div
            class="card p-8 rounded-lg w-11/12 md:w-1/2 lg:w-1/3 modal-content transform scale-95 max-h-[90vh] overflow-y-auto">
            <h3 class="text-2xl font-bold mb-6">Registrar Compra de Matéria-Prima</h3>
            <form id="form-nova-compra" class="space-y-4">
                <div>
                    <label for="insumo-tipo" class="block text-sm font-medium text-gray-700">Tipo de Item</label>
                    <select id="insumo-tipo" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"
                        required>
                        <option value="" disabled selected>Selecione o tipo...</option>
                        <option value="tecido">Tecido principal</option>
                        <option value="linha">Linha de costura</option>
                        <option value="botoes">Botões</option>
                        <option value="entretela">Entretela para reforço</option>
                        <option value="outros">Outros</option>
                    </select>
                </div>

                <div id="dynamic-form-fields" class="space-y-4">
                    <div id="fields-tecido" class="hidden space-y-4">
                        <div>
                            <label for="tecido-nome" class="block text-sm font-medium text-gray-700">Cor e Estampa (Nome
                                do Modelo)</label>
                            <input type="text" id="tecido-nome" list="estampas-list"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                            <datalist id="estampas-list"></datalist>
                        </div>
                        <div>
                            <label for="tecido-tipo" class="block text-sm font-medium text-gray-700">Tipo de
                                Tecido</label>
                            <input type="text" id="tecido-tipo" list="tipos-tecido-list"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                            <datalist id="tipos-tecido-list"></datalist>
                        </div>
                        <div>
                            <label for="tecido-fornecedor"
                                class="block text-sm font-medium text-gray-700">Fornecedor</label>
                            <input type="text" id="tecido-fornecedor" list="fornecedores-list"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                            <datalist id="fornecedores-list"></datalist>
                        </div>
                        <div class="pt-2 border-t">
                            <p class="text-sm font-medium text-gray-700 mb-2">Unidade de Medida</p>
                            <div id="tecido-unidade-group" class="flex items-center gap-6">
                                <label class="inline-flex items-center gap-2">
                                    <input type="radio" name="tecido-unidade" value="metros" checked
                                        class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>Metros</span>
                                </label>
                                <label class="inline-flex items-center gap-2">
                                    <input type="radio" name="tecido-unidade" value="un"
                                        class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>Unidade</span>
                                </label>
                            </div>
                        </div>
                        <div>
                            <label for="collection-sizes" class="block text-sm font-medium text-gray-700">Tamanhos
                                (separados por vírgula)</label>
                            <input type="text" id="collection-sizes" placeholder="PP, P, M, G, GG" value="P, M, G"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                        </div>
                    </div>

                    <div id="fields-linha" class="hidden space-y-4">
                        <div><label class="block text-sm font-medium text-gray-700">Cor da Linha</label><input
                                type="text" id="linha-nome"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                        <div><label class="block text-sm font-medium text-gray-700">Tipo</label><input type="text"
                                id="linha-composicao"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                        <div><label class="block text-sm font-medium text-gray-700">Espessura</label><input type="text"
                                id="linha-espessura"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                        <div><label class="block text-sm font-medium text-gray-700">Fornecedor</label><input type="text"
                                id="linha-fornecedor"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                    </div>
                    <div id="fields-botoes" class="hidden space-y-4">
                        <div><label class="block text-sm font-medium text-gray-700">Cor</label><input type="text"
                                id="botoes-nome"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                        <div><label class="block text-sm font-medium text-gray-700">Material</label><input type="text"
                                id="botoes-material"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                        <div><label class="block text-sm font-medium text-gray-700">Tamanho</label><input type="text"
                                id="botoes-tamanho"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                        <div><label class="block text-sm font-medium text-gray-700">Fornecedor</label><input type="text"
                                id="botoes-fornecedor"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                    </div>
                    <div id="fields-entretela" class="hidden space-y-4">
                        <div><label class="block text-sm font-medium text-gray-700">Nome</label><input type="text"
                                id="entretela-nome"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                        <div><label class="block text-sm font-medium text-gray-700">Tipo</label><select
                                id="entretela-tipo" class="mt-1 block w-full border border-gray-300 p-2">
                                <option>Termocolante</option>
                                <option>Não termocolante</option>
                            </select></div>
                        <div><label class="block text-sm font-medium text-gray-700">Fornecedor</label><input type="text"
                                id="entretela-fornecedor" class="mt-1 block w-full border border-gray-300 p-2"></div>
                    </div>
                    <div id="fields-outros" class="hidden space-y-4">
                        <div><label class="block text-sm font-medium text-gray-700">Nome</label><input type="text"
                                id="outros-nome" class="mt-1 block w-full border border-gray-300 p-2"></div>
                    </div>
                </div>

                <div id="common-fields" class="hidden space-y-4 pt-4 border-t">
                    <div class="grid grid-cols-2 gap-4">
                        <div id="common-unidade-group">
                            <label for="insumo-unidade" class="block text-sm font-medium text-gray-700">Unidade</label>
                            <input type="text" id="insumo-unidade" placeholder="metros, un"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                        </div>
                        <div>
                            <label for="insumo-custo"
                                class="block text-sm font-medium text-gray-700">Custo/Unidade</label>
                            <input type="number" step="0.01" id="insumo-custo" min="0" placeholder="R$"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label for="insumo-qtd-comprada" class="block text-sm font-medium text-gray-700">Qtd.
                                Comprada</label>
                            <input type="number" step="0.01" id="insumo-qtd-comprada" min="0"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                        </div>
                        <div>
                            <label for="insumo-estoque-minimo" class="block text-sm font-medium text-gray-700">Estoque
                                Mínimo</label>
                            <input type="number" step="0.01" id="insumo-estoque-minimo" min="0" value="5"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" onclick="closeModal('modal-nova-compra')"
                        class="font-semibold py-2 px-4 rounded-md border border-gray-300 hover:bg-gray-100">Cancelar</button>
                    <button type="submit" class="btn-primary font-semibold py-2 px-4 rounded-md">Salvar Compra</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-editar-insumo"
        class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop opacity-0">
        <div class="card p-8 rounded-lg w-11/12 md:w-1/2 lg:w-1/3 modal-content transform scale-95">
            <h3 class="text-2xl font-bold mb-6">Editar Matéria-Prima</h3>
            <form id="form-editar-insumo" class="space-y-4">
                <input type="hidden" id="edit-insumo-id">
                <div>
                    <label for="edit-insumo-nome" class="block text-sm font-medium text-gray-700">Nome do Insumo</label>
                    <input type="text" id="edit-insumo-nome"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                </div>
                <div>
                    <label for="edit-insumo-unidade" class="block text-sm font-medium text-gray-700">Unidade de
                        Medida</label>
                    <input type="text" id="edit-insumo-unidade"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="edit-insumo-custo" class="block text-sm font-medium text-gray-700">Custo por Unidade
                        (R$)</label>
                    <input type="number" step="0.01" id="edit-insumo-custo" min="0"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="edit-insumo-estoque" class="block text-sm font-medium text-gray-700">Quantidade em
                        Estoque</label>
                    <input type="number" step="0.01" id="edit-insumo-estoque" min="0"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div>
                    <label for="edit-insumo-estoque-minimo" class="block text-sm font-medium text-gray-700">Estoque
                        Mínimo</label>
                    <input type="number" step="0.01" id="edit-insumo-estoque-minimo" min="0" class="mt-1 block w-full border border-gray-300 
rounded-md shadow-sm p-2" required>
                </div>
                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" onclick="closeModal('modal-editar-insumo')"
                        class="font-semibold py-2 px-4 rounded-md border border-gray-300 hover:bg-gray-100">Cancelar</button>
                    <button type="submit" class="btn-primary font-semibold py-2 px-4 rounded-md">Salvar
                        Alterações</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-confirmar-exclusao"
        class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop opacity-0">
        <div class="card p-8 rounded-lg w-11/12 md:w-1/2 lg:w-1/3 modal-content transform scale-95">
            <div class="flex items-center mb-4">
                <div class="bg-red-100 text-red-600 p-3 rounded-full mr-4 shrink-0">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                        </path>
                    </svg>
                </div>
                <div>
                    <h3 class="text-xl font-bold">Confirmar Exclusão</h3>
                </div>
            </div>
            <p id="delete-confirm-message" class="text-gray-600 mb-6 ml-16">Tem certeza?</p>
            <div class="flex justify-end space-x-4">
                <button type="button" onclick="closeModal('modal-confirmar-exclusao')"
                    class="font-semibold py-2 px-4 rounded-md border border-gray-300 hover:bg-gray-100">Cancelar</button>
                <button id="btn-confirmar-exclusao" type="button"
                    class="btn-danger font-semibold py-2 px-4 rounded-md">Sim, Excluir</button>
            </div>
        </div>
    </div>

    <div id="modal-nova-producao"
        class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop opacity-0">
        <div
            class="card p-8 rounded-lg w-11/12 md:w-2/3 lg:w-1/2 modal-content transform scale-95 max-h-[90vh] overflow-y-auto">
            <h3 class="text-2xl font-bold mb-6">Registrar Lote de Produção</h3>
            <form id="form-nova-producao" class="space-y-6">
                <div>
                    <h4 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4">1. Detalhes do Lote</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div><label class="block text-sm font-medium text-gray-700">N° do Lote</label><input type="text"
                                id="producao-lote"
                                class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2 bg-gray-100" readonly
                                required></div>
                        <div><label class="block text-sm font-medium text-gray-700">Data do Pedido</label><input
                                type="text" id="producao-data"
                                class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2" required></div>
                        <div><label class="block text-sm font-medium text-gray-700">Data da Entrega</label><input
                                type="text" id="producao-data-entrega"
                                class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2"></div>
                        <div class="lg:col-span-3"><label class="block text-sm font-medium text-gray-700">Produto
                                (SKU)</label><select id="producao-sku"
                                class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2" required></select>
                        </div>
                        <div><label class="block text-sm font-medium text-gray-700">Qtd</label><input type="number"
                                id="producao-qtd" min="1"
                                class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2" required></div>
                        <div><label class="block text-sm font-medium text-gray-700">Mão de Obra</label><input
                                type="number" id="producao-mao-de-obra" min="0" step="0.01"
                                class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2" required></div>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4">2. Insumos Utilizados</h4>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                            <div class="md:col-span-2 grid grid-cols-3 gap-4">
                                <div class="col-span-2"><label class="block text-sm font-medium text-gray-700">Adicionar
                                        Insumo</label><select id="producao-insumo-select"
                                        class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2"></select>
                                </div>
                                <div><label class="block text-sm font-medium text-gray-700">Qtd</label><input
                                        type="number" id="producao-insumo-qtd"
                                        class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2"></div>
                            </div>
                            <div class="md:col-span-2"><button type="button" id="btn-add-insumo-producao"
                                    class="w-full btn-primary h-10 px-4 rounded-md">Adicionar</button></div>
                        </div>
                        <ul id="producao-insumos-list" class="mt-4 space-y-2 max-h-40 overflow-y-auto"></ul>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4">3. Resumo e Status</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
                        <div><label class="block text-sm font-medium text-gray-700">Status</label><select
                                id="producao-status" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2">
                                <option>Em Produção</option>
                                <option>Recebido</option>
                            </select></div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-gray-700">Custo Total: <span id="producao-custo-total">R$
                                    0,00</span></p>
                            <p class="text-sm text-gray-500" id="producao-custo-peca">R$ 0,00/peça</p>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-4 pt-4 border-t mt-6">
                    <button type="button" onclick="closeModal('modal-nova-producao')"
                        class="font-semibold py-2 px-4 rounded-md border border-gray-300 hover:bg-gray-100">Cancelar</button>
                    <button type="submit" class="btn-primary font-semibold py-2 px-4 rounded-md">Salvar Lote</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-editar-producao"
        class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop opacity-0">
        <div class="card p-8 rounded-lg w-11/12 md:w-1/2 lg:w-1/3 modal-content transform scale-95">
            <h3 class="text-2xl font-bold mb-6">Editar Lote de Produção</h3>
            <form id="form-editar-producao" class="space-y-4">
                <input type="hidden" id="edit-producao-id">
                <input type="hidden" id="edit-producao-old-status">
                <input type="hidden" id="edit-producao-produto-id">
                <input type="hidden" id="edit-producao-old-qtd" value="0">
                <div>
                    <label class="block text-sm font-medium text-gray-700">N° do Lote</label>
                    <p id="edit-producao-lote" class="mt-1 block w-full p-2 bg-gray-100 rounded-md"></p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Data da Entrega</label>
                    <input type="text" id="edit-producao-data-entrega" placeholder="AAAA-MM-DD"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Status</label>
                    <select id="edit-producao-status"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
                        <option>Em Produção</option>
                        <option>Recebido</option>
                    </select>
                </div>
                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" onclick="closeModal('modal-editar-producao')"
                        class="font-semibold py-2 px-4 rounded-md border border-gray-300 hover:bg-gray-100">Cancelar</button>
                    <button type="submit" class="btn-primary font-semibold py-2 px-4 rounded-md">Salvar
                        Alterações</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-nova-transacao"
        class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop opacity-0">
        <div class="card p-8 rounded-lg w-11/12 md:w-1/2 lg:w-1/3 modal-content transform scale-95">
            <h3 id="modal-transacao-title" class="text-2xl font-bold mb-6">Adicionar Transação Manual</h3>
            <form id="form-nova-transacao" class="space-y-4">
                <input type="hidden" id="transacao-id">
                <div><label class="block text-sm font-medium text-gray-700">Data</label><input type="text"
                        id="transacao-data" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2" required>
                </div>
                <div><label class="block text-sm font-medium text-gray-700">Descrição</label><input type="text"
                        id="transacao-descricao" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2"
                        required></div>
                <div><label class="block text-sm font-medium text-gray-700">Tipo</label><select id="transacao-tipo"
                        class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2" required>
                        <option value="entrada">Entrada</option>
                        <option value="saida">Saída</option>
                    </select></div>
                <div><label class="block text-sm font-medium text-gray-700">Categoria</label><input type="text"
                        id="transacao-categoria" list="categorias-list"
                        class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2" required></div>
                <div><label class="block text-sm font-medium text-gray-700">Valor (R$)</label><input type="number"
                        step="0.01" id="transacao-valor" min="0"
                        class="mt-1 block w-full border-gray-300 rounded-md shadow-sm p-2" required></div>
                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" onclick="closeModal('modal-nova-transacao')"
                        class="font-semibold py-2 px-4 rounded-md border border-gray-300 hover:bg-gray-100">Cancelar</button>
                    <button type="submit" class="btn-primary font-semibold py-2 px-4 rounded-md">Salvar
                        Transação</button>
                </div>
            </form>
        </div>
    </div>

    <div id="loading-overlay" class="fixed inset-0 bg-white bg-opacity-75 z-50 flex items-center justify-center">
        <div class="text-center">
            <svg class="animate-spin h-8 w-8 text-blue-500 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none"
                viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
            </svg>
            <p id="loading-spinner" class="mt-2 text-lg font-semibold text-gray-700">Carregando dados...</p>
        </div>
    </div>
    <div id="toast-container" role="status" aria-live="polite" class="fixed bottom-5 right-5 z-50 space-y-2"></div>
    <script type="module" src="js/app.js"></script>
</body>

</html>